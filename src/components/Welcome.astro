---
import { Image } from "astro:assets";
import img from "../assets/images/1669815075078.jpg";
import Projects from "./Projects.astro";
import AboutArrow from "./AboutArrow.astro";
---

<section class="w-full min-h-screen text-gray-100 flex flex-col">
	<!-- Intro hero -->
	<div id="welcome" class="max-w-6xl mx-auto flex-1 flex items-center px-4">
		<div class="w-full">
			<!-- Foto grande en círculo encima del saludo -->
			<div class="flex items-center gap-4 mb-6">
				<Image
					src={img}
					alt="Foto de Juan Marcos Rodriguez Tapiz"
					class="w-20 h-20 md:w-32 md:h-32 rounded-full object-cover border-4 border-gray-700"
				/>
				<h1 class="text-5xl leading-tight">
					Juan Marcos Rodriguez Tapiz
				</h1>
			</div>

			<h1 class="text-3xl md:text-5xl font-bold tracking-tight">
				Hola, soy un desarrollador fullstack apasionado por crear
				soluciones.
			</h1>
			<p class="mt-3 text-sm md:text-base text-gray-300 max-w-2xl">
				Pienso y construyo aplicaciones con la intención de mejorar la
				experiencia de los usuarios, aprendiendo y evolucionando en cada
				proyecto. Busco un equipo en el que pueda aportar, colaborar y
				crecer tanto en lo técnico como en lo profesional.
			</p>
			<div class="mt-5 flex gap-3">
				<!-- Cambiar a botón para evitar navegación -->
				<button
					id="open-projects"
					type="button"
					class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded-md transition-colors"
					aria-controls="projects-modal"
				>
					Ver proyectos
				</button>
				<!-- Botón LinkedIn (abre en nueva pestaña) -->
				<a
					href="https://www.linkedin.com/in/juan-marcos-rodriguez-398a3224a/"
					target="_blank"
					rel="noopener noreferrer"
					aria-label="Abrir LinkedIn"
					class="px-3 py-2 border border-gray-700 hover:border-gray-500 text-gray-200 text-sm rounded-md transition-colors inline-flex items-center gap-2"
				>
					<!-- Icono LinkedIn -->
					<svg
						viewBox="0 0 24 24"
						fill="currentColor"
						aria-hidden="true"
						class="w-5 h-5"
					>
						<path
							d="M4.98 3.5C4.98 4.88 3.86 6 2.48 6S0 4.88 0 3.5 1.12 1 2.48 1s2.5 1.12 2.5 2.5zM.5 8.5h4v15h-4v-15zm7.98 0h3.83v2.07h.05c.53-1 1.84-2.07 3.79-2.07 4.05 0 4.8 2.67 4.8 6.14v8.86h-4v-7.84c0-1.87-.03-4.28-2.61-4.28-2.61 0-3.01 2.04-3.01 4.14v7.98h-4v-15z"
						></path>
					</svg>

					<span class="hidden md:inline">LinkedIn</span>
					<span class="sr-only">Abrir perfil de LinkedIn</span>
				</a>

				<!-- Botón GitHub (abre en nueva pestaña) -->
				<a
					href="https://github.com/KratosTheBot"
					target="_blank"
					rel="noopener noreferrer"
					aria-label="Abrir GitHub"
					class="px-3 py-2 border border-gray-700 hover:border-gray-500 text-gray-200 text-sm rounded-md transition-colors inline-flex items-center gap-2"
				>
					<!-- Icono GitHub -->
					<svg
						viewBox="0 0 24 24"
						fill="currentColor"
						aria-hidden="true"
						class="w-5 h-5"
					>
						<path
							d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.2 11.39.6.11.82-.26.82-.58 0-.29-.01-1.05-.02-2.06-3.34.73-4.04-1.61-4.04-1.61-.55-1.41-1.34-1.79-1.34-1.79-1.09-.75.08-.73.08-.73 1.2.09 1.83 1.23 1.83 1.23 1.07 1.83 2.81 1.3 3.5.99.11-.78.42-1.3.76-1.6-2.66-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.52.12-3.17 0 0 1.01-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.66 1.65.24 2.87.12 3.17.77.84 1.23 1.91 1.23 3.22 0 4.61-2.81 5.63-5.49 5.93.43.37.81 1.1.81 2.22 0 1.6-.01 2.89-.01 3.28 0 .32.21.7.83.58C20.57 21.8 24 17.3 24 12 24 5.37 18.63 0 12 0z"
						></path>
					</svg>
					<span class="hidden md:inline">GitHub</span>
					<span class="sr-only">Abrir perfil de GitHub</span>
				</a>

				<!-- Botón Email -> ahora navega a Contact -->
				<a
					href="/contact"
					aria-label="Ir a Contacto"
					class="px-3 py-2 border border-gray-700 hover:border-gray-500 text-gray-200 text-sm rounded-md transition-colors inline-flex items-center gap-2"
				>
					<!-- Icono Email -->
					<svg
						viewBox="0 0 24 24"
						fill="currentColor"
						aria-hidden="true"
						class="w-5 h-5"
					>
						<path
							d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 3.25-7.2 4.5c-.27.17-.62.17-.89 0l-7.2-4.5A.75.75 0 0 1 4 6h16c.66 0 1.05.73.6 1.25z"
						></path>
					</svg>

					<span class="hidden md:inline">Contact</span>
					<span class="sr-only">Ir a la página de contacto</span>
				</a>
			</div>
		</div>
	</div>
</section>

<!-- Arrow button moved into this component -->
<AboutArrow position="right" />

<!-- Modal: carrousel de abajo a arriba -->
<div id="projects-modal" class="fixed inset-0 z-50 pointer-events-none">
	<!-- Backdrop -->
	<div
		id="projects-backdrop"
		class="absolute inset-0 bg-black/60 opacity-0 transition-opacity duration-300 z-40"
	>
	</div>
	<!-- Panel deslizante -->
	<div
		id="projects-panel"
		class="absolute left-0 right-0 bottom-0 translate-y-full transition-transform duration-300 z-50"
		tabindex="-1"
	>
		<div
			class="mx-auto max-w-6xl bg-[#0f1115] border border-gray-800 rounded-t-xl shadow-xl max-h-[80vh] overflow-y-auto"
		>
			<div
				class="flex items-center justify-between px-4 py-3 border-b border-gray-800 sticky top-0 bg-[#0f1115]"
			>
				<h2 class="text-2xl font-semibold text-white">Proyectos</h2>
				<button
					id="close-projects"
					type="button"
					class="text-gray-400 hover:text-white text-xs px-2 py-1 border border-gray-700 rounded"
				>
					Cerrar
				</button>
			</div>
			<div class="p-4">
				<Projects />
			</div>
		</div>
	</div>
</div>

<style>
	/* Arrow styles scoped to Welcome */
	.about-arrow {
		position: fixed;
		right: 20px;
		top: 50%;
		transform: translateY(-50%);
		z-index: 2;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		width: 48px;
		height: 48px;
		border-radius: 9999px;
		color: #cfe6ff;
		text-decoration: none;
		backdrop-filter: blur(4px);
		background: rgba(0, 71, 171, 0.15);
		box-shadow: 0 0 0 0 rgba(77, 163, 255, 0.6);
		animation:
			pulseXRight 2.2s ease-in-out infinite,
			glow 2.2s ease-in-out infinite;
	}
	.about-arrow:hover {
		background: rgba(0, 71, 171, 0.25);
		color: #ffffff;
	}
	.arrow-icon {
		font-size: 22px;
		line-height: 1;
		transform: translateX(0);
		animation: nudge 1.1s ease-in-out infinite;
	}
	@keyframes nudge {
		0%,
		100% {
			transform: translateX(0);
		}
		50% {
			transform: translateX(4px);
		}
	}
	@keyframes pulseXRight {
		0%,
		100% {
			transform: translateY(-50%) translateX(0);
		}
		50% {
			transform: translateY(-50%) translateX(-3px);
		}
	}
	@keyframes glow {
		0% {
			box-shadow: 0 0 0 0 rgba(77, 163, 255, 0);
		}
		50% {
			box-shadow: 0 0 12px 2px rgba(77, 163, 255, 0.35);
		}
		100% {
			box-shadow: 0 0 0 0 rgba(77, 163, 255, 0);
		}
	}

	/* Modal styles */
	#projects-modal.active {
		pointer-events: auto;
	}
	#projects-modal.active > div:first-child {
		opacity: 1;
	}
	#projects-modal.active > div:last-child {
		transform: translateY(0);
	}
</style>

<script is:inline>
	// Abrir/cerrar modal de proyectos con transición de abajo a arriba
	const openBtn = document.getElementById("open-projects");
	const modal = document.getElementById("projects-modal");
	const backdrop = document.getElementById("projects-backdrop");
	const panel = document.getElementById("projects-panel");
	const closeBtn = document.getElementById("close-projects");

	function openModal(e) {
		e?.preventDefault();
		modal?.classList.add("active");
		if (modal) modal.style.pointerEvents = "auto";
		if (backdrop) backdrop.style.opacity = "1";
		if (panel) {
			panel.classList.remove("translate-y-full");
			panel.classList.add("translate-y-0");
			panel.style.transform = "translateY(0)";
			panel.focus();
		}
	}

	function closeModal(e) {
		e?.preventDefault();
		modal?.classList.remove("active");
		if (modal) modal.style.pointerEvents = "none";
		if (backdrop) backdrop.style.opacity = "0";
		if (panel) {
			panel.classList.remove("translate-y-0");
			panel.classList.add("translate-y-full");
			panel.style.transform = "translateY(100%)";
		}
	}

	openBtn?.addEventListener("click", openModal);
	closeBtn?.addEventListener("click", closeModal);
	backdrop?.addEventListener("click", closeModal);

	document.addEventListener("keydown", (e) => {
		if (e.key === "Escape") closeModal(e);
	});
</script>
