---
interface Props {
    ariaLabel?: string;
    position?: "left" | "right";
}
const { ariaLabel, position = "right" } = Astro.props;
const isLeft = position === "left";
// explicit main target: left -> welcome, right -> about
const mainTarget = isLeft ? "welcome" : "about";
const computedAria =
    ariaLabel ?? (isLeft ? "Vista anterior" : "Vista siguiente");
---

<button
    type="button"
    class={`about-arrow ${isLeft ? "left" : "right"}`}
    aria-label={computedAria}
    onclick={`(function(){
        try {
            const target = '${mainTarget}';
            const ev = new CustomEvent('spa:navigate', {
                detail: { area: 'main', target },
                bubbles: true,
                composed: true
            });
            window.dispatchEvent(ev);
            document.dispatchEvent(ev);
            // Only update hash when going to 'about' to avoid router mismatches
            if (target === 'about') {
                var hash = '#about';
                if (window.location.hash !== hash) {
                    window.location.hash = hash;
                }
            }
        } catch (e) {
            if ('${mainTarget}' === 'about') {
                window.location.hash = '#about';
            }
        }
    })()`}
>
    <span
        class={`arrow-icon ${isLeft ? "arrow-icon-left" : "arrow-icon-right"}`}
    >
        {isLeft ? "⬅" : "➜"}
    </span>
</button>

<style>
    .about-arrow {
        /* reset default button styles */
        border: 0;
        appearance: none;
        cursor: pointer;
        /* remove default focus ring */
        outline: none;
        -webkit-tap-highlight-color: transparent;
        /* ...existing code... */
        position: fixed;
        top: 50%;
        transform: translateY(-50%);
        z-index: 2;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        border-radius: 9999px;
        /* ensure the blur/background is clipped to the circle */
        overflow: hidden;
        background-clip: padding-box;
        -webkit-backdrop-filter: blur(4px);
        color: #cfe6ff;
        text-decoration: none;
        backdrop-filter: blur(4px);
        background: rgba(0, 71, 171, 0.15);
        box-shadow: 0 0 0 0 rgba(77, 163, 255, 0.6);
        animation: glow 2.2s ease-in-out infinite;
    }
    .about-arrow:hover {
        background: rgba(0, 71, 171, 0.25);
        color: #ffffff;
    }
    .about-arrow:focus,
    .about-arrow:focus-visible {
        outline: none;
        /* keep accessible focus by reusing visual glow/hover */
        background: rgba(0, 71, 171, 0.25);
        color: #ffffff;
        box-shadow: 0 0 12px 2px rgba(77, 163, 255, 0.35);
    }
    .about-arrow::-moz-focus-inner {
        border: 0;
    }
    .about-arrow.right {
        right: 20px;
        animation-name: pulseXRight, glow;
    }
    .about-arrow.left {
        left: 20px;
        animation-name: pulseXLeft, glow;
    }

    .arrow-icon {
        font-size: 22px;
        line-height: 1;
    }
    .arrow-icon-right {
        animation: nudgeRight 1.1s ease-in-out infinite;
    }
    .arrow-icon-left {
        animation: nudgeLeft 1.1s ease-in-out infinite;
    }

    @keyframes nudgeRight {
        0%,
        100% {
            transform: translateX(0);
        }
        50% {
            transform: translateX(4px);
        }
    }
    @keyframes nudgeLeft {
        0%,
        100% {
            transform: translateX(0);
        }
        50% {
            transform: translateX(-4px);
        }
    }
    @keyframes pulseXRight {
        0%,
        100% {
            transform: translateY(-50%) translateX(0);
        }
        50% {
            transform: translateY(-50%) translateX(-3px);
        }
    }
    @keyframes pulseXLeft {
        0%,
        100% {
            transform: translateY(-50%) translateX(0);
        }
        50% {
            transform: translateY(-50%) translateX(3px);
        }
    }
    @keyframes glow {
        0% {
            box-shadow: 0 0 0 0 rgba(77, 163, 255, 0);
        }
        50% {
            box-shadow: 0 0 12px 2px rgba(77, 163, 255, 0.35);
        }
        100% {
            box-shadow: 0 0 0 0 rgba(77, 163, 255, 0);
        }
    }
</style>
